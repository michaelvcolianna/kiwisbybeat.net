---
import { getCollection } from 'astro:content'

const { series } = Astro.props

let sets;

if(series.data.series && !series.data.set) {
  const posts = await getCollection('posts')
  sets = posts.filter(set => set.data.series === series.data.series && set.data.set).sort((a, b) => {
    if (a.data.set && b.data.set) {
      if (a.data.set < b.data.set) {
        return -1
      }
      else if (a.data.set > b.data.set) {
        return 1
      }
    }

    return 0
  })
}

---

{sets?.length && (
  <nav>
    <ul>
      {sets.map(set => (
        <li><a href={`/${set.slug}`}>{series.data.title} - {set.data.title}</a></li>
      ))}
    </ul>
  </nav>
)}
